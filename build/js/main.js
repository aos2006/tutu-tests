'use strict';

var getOnlyBrackets = str => {
  var regexp = /[^()\[\]{},<>]/g;
  return str.replace(regexp, "");
};
var areBracketsInOrder = str => {
  let brackets = new Map([[']', '['], ['}', '{'], [')', '('], ['>', '<']]);
  let isClean = true;
  const iter = (i, len, isCleaning, brackets, cur, acc) => {
    if (i >= len && !isCleaning) return isCleaning && !acc.length;
    if (i >= len) return isCleaning && !acc.length;
    if (brackets.has(cur[i])) {
      let isCleaning = acc.pop() === brackets.get(cur[i]);
      return iter(++i, len, isCleaning, brackets, cur, acc);
    } else {
      acc.push(str[i]);
      return iter(++i, len, isCleaning, brackets, cur, acc);
    }
  };
  return iter(0, str.length, isClean, brackets, str, []);
};
var checkSyntax = str => {
  const newStr = getOnlyBrackets(str);
  return areBracketsInOrder(newStr) ? 0 : 1;
};
console.log('checkSyntax');
console.log(checkSyntax("---((((((()))))))----") === 0);
console.log(checkSyntax("") === 0);
console.log(checkSyntax("before ( middle []) after ") === 0);
console.log(checkSyntax(") (") === 1);
console.log(checkSyntax("} {") === 1);
console.log(checkSyntax("<>(])") === 1);
console.log(checkSyntax("(  [  <>  ()  ]  <>  )") === 0);
console.log(checkSyntax("   (      [)") === 1);
'use strict';

let dsCount = (...args) => {
  const [str, ...rest] = args;
  const concatedSubstings = rest.join('');
  const iter = (count, position, curr, substring) => {
    if (curr.indexOf(substring, position) === -1) return count;

    let newPosition = curr.indexOf(substring, position);
    return iter(++count, ++newPosition, curr, substring);
  };

  return iter(0, 0, str.toLowerCase(), concatedSubstings.toLowerCase());
};
console.log('dsCount');
try {
  test(dsCount, ['ab___ab__', 'a', 'b'], 2);
  test(dsCount, ['___cd____', 'c', 'd'], 1);
  test(dsCount, ['de_______', 'd', 'e'], 1);
  test(dsCount, ['12_12__12', '1', '2'], 3);
  test(dsCount, ['_ba______', 'a', 'b'], 0);
  test(dsCount, ['_a__b____', 'a', 'b'], 0);
  test(dsCount, ['-ab-аb-ab', 'a', 'b'], 2);
  test(dsCount, ['aAa', 'a', 'a'], 2);
  console.info("Congratulations! All tests success passed.");
} catch (e) {
  console.error(e);
}

// Простая функция тестирования

function test(call, args, count, n) {
  let r = call.apply(n, args) === count;
  console.assert(r, `Finded items count: ${count}`);
  if (!r) throw "Test failed!";
}
console.log('parseUrl');
let parseUrl = url => {
    let a = document.createElement('a');
    a.href = url;
    return new Map([['href', url], ['protocol', a.protocol], ['hostname', a.hostname], ['hash', a.hash], ['port', a.port], ['host', a.host], ['pathname', a.pathname], ['origin', a.origin]]);
};

let a = parseUrl('http://tutu.ru:8080/do/any.php?a=1&b[]=a&b[]=b#foo');

console.log(a.get('href'));
console.log(a.get('hash'));
console.log(a.get('port'));
console.log(a.get('host'));
console.log(a.get('protocol'));
console.log(a.get('hostname'));
console.log(a.get('pathname'));
console.log(a.get('origin'));
//Задача #1
const getSubstring = ({ str, subStr1, subStr2 }) => {
  if (str === '') return -1;
  let subStrPosition1 = str.lastIndexOf(subStr1, str.length - 1);
  let subStrPosition2 = str.lastIndexOf(subStr2, str.length - 1);

  return subStrPosition1 !== -1 ? subStrPosition1 : subStrPosition2 !== -1 ? subStrPosition2 : subStrPosition1 === subStrPosition2 ? subStrPosition1 : -1;
};

function func(s, a, b) {

  if (s.match(/^$/)) {
    return -1;
  }

  var i = s.length - 1;
  var aIndex = -1;
  var bIndex = -1;

  while (aIndex == -1 && bIndex == -1 && i > 0) {
    if (s.substring(i, i + 1) == a) {
      aIndex = i;
    }
    if (s.substring(i, i + 1) == b) {
      bIndex = i;
    }
    i = i - 1;
  }
  if (aIndex != -1) {
    if (bIndex == -1) {
      return aIndex;
    } else {
      return Math.max(aIndex, bIndex);
    }
  }

  if (bIndex != -1) {
    return bIndex;
  } else {
    return -1;
  }
}

console.log('Refactoring task 1', func('12345560', '0', '0'), getSubstring({ str: '12345560', subStr1: '0', subStr2: '0' }));

//Задача 2
const drawRating = (vote, range = [0, 20], stars = '★☆☆☆☆') => {
  if (vote >= range[0] && vote <= range[1]) return stars;
  return new Error('Что то пошло не так, проверьте аргументы');
};

//function drawRating(vote) {
//  if (vote >= 0 && vote <= 20) {
//    return '★☆☆☆☆';
//  }
//  else if (vote > 20 && vote <= 40) {
//    return '★★☆☆☆';
//  }
//  else if (vote > 40 && vote <= 60) {
//    return '★★★☆☆';
//  }
//  else if (vote > 60 && vote <= 80) {
//    return '★★★★☆';
//  }
//  else if (vote > 80 && vote <= 100) {
//    return '★★★★★';
//  }
//}

// Проверка работы результата
console.log(drawRating(0, [0, 20], '★☆☆☆☆')); // ★☆☆☆☆
console.log(drawRating(1, [0, 20], '★☆☆☆☆')); // ★☆☆☆☆
console.log(drawRating(50, [40, 60], '★★★☆☆')); // ★★★☆☆
console.log(drawRating(99, [80, 100], '★★★★★')); // ★★★★★
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrU3ludGF4LmpzIiwiZHNDb3VudC5qcyIsInBhcnNlVXJsLmpzIiwicmVmYWN0b3JpbmcuanMiXSwibmFtZXMiOlsiZ2V0T25seUJyYWNrZXRzIiwic3RyIiwicmVnZXhwIiwicmVwbGFjZSIsImFyZUJyYWNrZXRzSW5PcmRlciIsImJyYWNrZXRzIiwiTWFwIiwiaXNDbGVhbiIsIml0ZXIiLCJpIiwibGVuIiwiaXNDbGVhbmluZyIsImN1ciIsImFjYyIsImxlbmd0aCIsImhhcyIsInBvcCIsImdldCIsInB1c2giLCJjaGVja1N5bnRheCIsIm5ld1N0ciIsImNvbnNvbGUiLCJsb2ciLCJkc0NvdW50IiwiYXJncyIsInJlc3QiLCJjb25jYXRlZFN1YnN0aW5ncyIsImpvaW4iLCJjb3VudCIsInBvc2l0aW9uIiwiY3VyciIsInN1YnN0cmluZyIsImluZGV4T2YiLCJuZXdQb3NpdGlvbiIsInRvTG93ZXJDYXNlIiwidGVzdCIsImluZm8iLCJlIiwiZXJyb3IiLCJjYWxsIiwibiIsInIiLCJhcHBseSIsImFzc2VydCIsInBhcnNlVXJsIiwidXJsIiwiYSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJwcm90b2NvbCIsImhvc3RuYW1lIiwiaGFzaCIsInBvcnQiLCJob3N0IiwicGF0aG5hbWUiLCJvcmlnaW4iLCJnZXRTdWJzdHJpbmciLCJzdWJTdHIxIiwic3ViU3RyMiIsInN1YlN0clBvc2l0aW9uMSIsImxhc3RJbmRleE9mIiwic3ViU3RyUG9zaXRpb24yIiwiZnVuYyIsInMiLCJiIiwibWF0Y2giLCJhSW5kZXgiLCJiSW5kZXgiLCJNYXRoIiwibWF4IiwiZHJhd1JhdGluZyIsInZvdGUiLCJyYW5nZSIsInN0YXJzIiwiRXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBOztBQUNBLElBQUlBLGtCQUFtQkMsR0FBRCxJQUFTO0FBQzdCLE1BQUlDLFNBQVMsaUJBQWI7QUFDQSxTQUFRRCxHQUFELENBQU1FLE9BQU4sQ0FBY0QsTUFBZCxFQUFzQixFQUF0QixDQUFQO0FBQ0QsQ0FIRDtBQUlBLElBQUlFLHFCQUFzQkgsR0FBRCxJQUFTO0FBQ2hDLE1BQUlJLFdBQVcsSUFBSUMsR0FBSixDQUNYLENBQ0ksQ0FBQyxHQUFELEVBQU0sR0FBTixDQURKLEVBRUksQ0FBQyxHQUFELEVBQU0sR0FBTixDQUZKLEVBR0ksQ0FBQyxHQUFELEVBQU0sR0FBTixDQUhKLEVBSUksQ0FBQyxHQUFELEVBQU0sR0FBTixDQUpKLENBRFcsQ0FBZjtBQVFBLE1BQUlDLFVBQVUsSUFBZDtBQUNBLFFBQU1DLE9BQU8sQ0FBQ0MsQ0FBRCxFQUFJQyxHQUFKLEVBQVNDLFVBQVQsRUFBcUJOLFFBQXJCLEVBQStCTyxHQUEvQixFQUFvQ0MsR0FBcEMsS0FBNEM7QUFDdkQsUUFBSUosS0FBS0MsR0FBTCxJQUFZLENBQUNDLFVBQWpCLEVBQTZCLE9BQU9BLGNBQWMsQ0FBQ0UsSUFBSUMsTUFBMUI7QUFDN0IsUUFBSUwsS0FBS0MsR0FBVCxFQUFjLE9BQU9DLGNBQWMsQ0FBQ0UsSUFBSUMsTUFBMUI7QUFDZCxRQUFJVCxTQUFTVSxHQUFULENBQWFILElBQUlILENBQUosQ0FBYixDQUFKLEVBQTBCO0FBQ3hCLFVBQUlFLGFBQWFFLElBQUlHLEdBQUosT0FBY1gsU0FBU1ksR0FBVCxDQUFhTCxJQUFJSCxDQUFKLENBQWIsQ0FBL0I7QUFDQSxhQUFPRCxLQUFLLEVBQUVDLENBQVAsRUFBVUMsR0FBVixFQUFlQyxVQUFmLEVBQTJCTixRQUEzQixFQUFxQ08sR0FBckMsRUFBMENDLEdBQTFDLENBQVA7QUFDRCxLQUhELE1BR087QUFDTEEsVUFBSUssSUFBSixDQUFTakIsSUFBSVEsQ0FBSixDQUFUO0FBQ0EsYUFBT0QsS0FBSyxFQUFFQyxDQUFQLEVBQVVDLEdBQVYsRUFBZUMsVUFBZixFQUEyQk4sUUFBM0IsRUFBcUNPLEdBQXJDLEVBQTBDQyxHQUExQyxDQUFQO0FBQ0Q7QUFDRixHQVZEO0FBV0EsU0FBT0wsS0FBSyxDQUFMLEVBQVFQLElBQUlhLE1BQVosRUFBb0JQLE9BQXBCLEVBQTZCRixRQUE3QixFQUF1Q0osR0FBdkMsRUFBNEMsRUFBNUMsQ0FBUDtBQUNELENBdEJEO0FBdUJBLElBQUlrQixjQUFlbEIsR0FBRCxJQUFTO0FBQ3pCLFFBQU1tQixTQUFTcEIsZ0JBQWdCQyxHQUFoQixDQUFmO0FBQ0EsU0FBT0csbUJBQW1CZ0IsTUFBbkIsSUFBNkIsQ0FBN0IsR0FBaUMsQ0FBeEM7QUFDRCxDQUhEO0FBSUFDLFFBQVFDLEdBQVIsQ0FBWSxhQUFaO0FBQ0FELFFBQVFDLEdBQVIsQ0FBYUgsWUFBWSx1QkFBWixNQUF5QyxDQUF0RDtBQUNBRSxRQUFRQyxHQUFSLENBQWFILFlBQWEsRUFBYixNQUFxQixDQUFsQztBQUNBRSxRQUFRQyxHQUFSLENBQWFILFlBQWEsNEJBQWIsTUFBK0MsQ0FBNUQ7QUFDQUUsUUFBUUMsR0FBUixDQUFhSCxZQUFhLEtBQWIsTUFBd0IsQ0FBckM7QUFDQUUsUUFBUUMsR0FBUixDQUFhSCxZQUFhLEtBQWIsTUFBd0IsQ0FBckM7QUFDQUUsUUFBUUMsR0FBUixDQUFhSCxZQUFhLE9BQWIsTUFBMEIsQ0FBdkM7QUFDQUUsUUFBUUMsR0FBUixDQUFhSCxZQUFhLHdCQUFiLE1BQTJDLENBQXhEO0FBQ0FFLFFBQVFDLEdBQVIsQ0FBYUgsWUFBYSxjQUFiLE1BQWlDLENBQTlDO0FDeENBOztBQUNBLElBQUlJLFVBQVUsQ0FBQyxHQUFHQyxJQUFKLEtBQWE7QUFDekIsUUFBTSxDQUFDdkIsR0FBRCxFQUFNLEdBQUd3QixJQUFULElBQWlCRCxJQUF2QjtBQUNBLFFBQU1FLG9CQUFvQkQsS0FBS0UsSUFBTCxDQUFVLEVBQVYsQ0FBMUI7QUFDQSxRQUFNbkIsT0FBTyxDQUFDb0IsS0FBRCxFQUFRQyxRQUFSLEVBQWtCQyxJQUFsQixFQUF3QkMsU0FBeEIsS0FBc0M7QUFDL0MsUUFBR0QsS0FBS0UsT0FBTCxDQUFhRCxTQUFiLEVBQXdCRixRQUF4QixNQUFzQyxDQUFDLENBQTFDLEVBQTZDLE9BQU9ELEtBQVA7O0FBRTdDLFFBQUlLLGNBQWNILEtBQUtFLE9BQUwsQ0FBYUQsU0FBYixFQUF3QkYsUUFBeEIsQ0FBbEI7QUFDQSxXQUFPckIsS0FBSyxFQUFFb0IsS0FBUCxFQUFjLEVBQUVLLFdBQWhCLEVBQTZCSCxJQUE3QixFQUFtQ0MsU0FBbkMsQ0FBUDtBQUNILEdBTEQ7O0FBT0EsU0FBT3ZCLEtBQUssQ0FBTCxFQUFRLENBQVIsRUFBV1AsSUFBSWlDLFdBQUosRUFBWCxFQUE4QlIsa0JBQWtCUSxXQUFsQixFQUE5QixDQUFQO0FBR0QsQ0FiRDtBQWNBYixRQUFRQyxHQUFSLENBQVksU0FBWjtBQUNBLElBQUk7QUFDRmEsT0FBS1osT0FBTCxFQUFjLENBQUMsV0FBRCxFQUFjLEdBQWQsRUFBbUIsR0FBbkIsQ0FBZCxFQUF1QyxDQUF2QztBQUNBWSxPQUFLWixPQUFMLEVBQWMsQ0FBQyxXQUFELEVBQWMsR0FBZCxFQUFtQixHQUFuQixDQUFkLEVBQXVDLENBQXZDO0FBQ0FZLE9BQUtaLE9BQUwsRUFBYyxDQUFDLFdBQUQsRUFBYyxHQUFkLEVBQW1CLEdBQW5CLENBQWQsRUFBdUMsQ0FBdkM7QUFDQVksT0FBS1osT0FBTCxFQUFjLENBQUMsV0FBRCxFQUFjLEdBQWQsRUFBbUIsR0FBbkIsQ0FBZCxFQUF1QyxDQUF2QztBQUNBWSxPQUFLWixPQUFMLEVBQWMsQ0FBQyxXQUFELEVBQWMsR0FBZCxFQUFtQixHQUFuQixDQUFkLEVBQXVDLENBQXZDO0FBQ0FZLE9BQUtaLE9BQUwsRUFBYyxDQUFDLFdBQUQsRUFBYyxHQUFkLEVBQW1CLEdBQW5CLENBQWQsRUFBdUMsQ0FBdkM7QUFDQVksT0FBS1osT0FBTCxFQUFjLENBQUMsV0FBRCxFQUFjLEdBQWQsRUFBbUIsR0FBbkIsQ0FBZCxFQUF1QyxDQUF2QztBQUNBWSxPQUFLWixPQUFMLEVBQWMsQ0FBQyxLQUFELEVBQVEsR0FBUixFQUFhLEdBQWIsQ0FBZCxFQUFpQyxDQUFqQztBQUNBRixVQUFRZSxJQUFSLENBQWEsNENBQWI7QUFDRCxDQVZELENBVUUsT0FBTUMsQ0FBTixFQUFTO0FBQ1RoQixVQUFRaUIsS0FBUixDQUFjRCxDQUFkO0FBQ0Q7O0FBRUQ7O0FBRUEsU0FBU0YsSUFBVCxDQUFjSSxJQUFkLEVBQW9CZixJQUFwQixFQUEwQkksS0FBMUIsRUFBaUNZLENBQWpDLEVBQW9DO0FBQ2xDLE1BQUlDLElBQUtGLEtBQUtHLEtBQUwsQ0FBV0YsQ0FBWCxFQUFjaEIsSUFBZCxNQUF3QkksS0FBakM7QUFDQVAsVUFBUXNCLE1BQVIsQ0FBZUYsQ0FBZixFQUFtQix1QkFBc0JiLEtBQU0sRUFBL0M7QUFDQSxNQUFJLENBQUNhLENBQUwsRUFBUSxNQUFNLGNBQU47QUFDVDtBQ3BDRHBCLFFBQVFDLEdBQVIsQ0FBWSxVQUFaO0FBQ0EsSUFBSXNCLFdBQVlDLEdBQUQsSUFBUztBQUN0QixRQUFJQyxJQUFJQyxTQUFTQyxhQUFULENBQXVCLEdBQXZCLENBQVI7QUFDQUYsTUFBRUcsSUFBRixHQUFTSixHQUFUO0FBQ0EsV0FBTyxJQUFJdkMsR0FBSixDQUFRLENBQ1gsQ0FBQyxNQUFELEVBQVN1QyxHQUFULENBRFcsRUFFWCxDQUFDLFVBQUQsRUFBYUMsRUFBRUksUUFBZixDQUZXLEVBR1gsQ0FBQyxVQUFELEVBQWFKLEVBQUVLLFFBQWYsQ0FIVyxFQUlYLENBQUMsTUFBRCxFQUFTTCxFQUFFTSxJQUFYLENBSlcsRUFLWCxDQUFDLE1BQUQsRUFBU04sRUFBRU8sSUFBWCxDQUxXLEVBTVgsQ0FBQyxNQUFELEVBQVNQLEVBQUVRLElBQVgsQ0FOVyxFQU9YLENBQUMsVUFBRCxFQUFhUixFQUFFUyxRQUFmLENBUFcsRUFRWCxDQUFDLFFBQUQsRUFBV1QsRUFBRVUsTUFBYixDQVJXLENBQVIsQ0FBUDtBQVVELENBYkQ7O0FBZUEsSUFBSVYsSUFBSUYsU0FBUyxvREFBVCxDQUFSOztBQUVBdkIsUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxNQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxNQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxNQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxNQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxVQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxVQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxVQUFOLENBQVo7QUFDQUksUUFBUUMsR0FBUixDQUFZd0IsRUFBRTdCLEdBQUYsQ0FBTSxRQUFOLENBQVo7QUN6QkE7QUFDQSxNQUFNd0MsZUFBZSxDQUFDLEVBQUN4RCxHQUFELEVBQU15RCxPQUFOLEVBQWVDLE9BQWYsRUFBRCxLQUE2QjtBQUNoRCxNQUFJMUQsUUFBUSxFQUFaLEVBQWdCLE9BQU8sQ0FBQyxDQUFSO0FBQ2hCLE1BQUkyRCxrQkFBa0IzRCxJQUFJNEQsV0FBSixDQUFnQkgsT0FBaEIsRUFBeUJ6RCxJQUFJYSxNQUFKLEdBQWEsQ0FBdEMsQ0FBdEI7QUFDQSxNQUFJZ0Qsa0JBQWtCN0QsSUFBSTRELFdBQUosQ0FBZ0JGLE9BQWhCLEVBQXlCMUQsSUFBSWEsTUFBSixHQUFhLENBQXRDLENBQXRCOztBQUVBLFNBQU84QyxvQkFBb0IsQ0FBQyxDQUFyQixHQUF5QkEsZUFBekIsR0FDQUUsb0JBQW9CLENBQUMsQ0FBckIsR0FBeUJBLGVBQXpCLEdBQ0FGLG9CQUFvQkUsZUFBcEIsR0FBc0NGLGVBQXRDLEdBQXdELENBQUMsQ0FGaEU7QUFJRCxDQVREOztBQVdBLFNBQVNHLElBQVQsQ0FBY0MsQ0FBZCxFQUFpQmxCLENBQWpCLEVBQW9CbUIsQ0FBcEIsRUFBdUI7O0FBRXJCLE1BQUlELEVBQUVFLEtBQUYsQ0FBUSxJQUFSLENBQUosRUFBbUI7QUFDakIsV0FBTyxDQUFDLENBQVI7QUFDRDs7QUFFRCxNQUFJekQsSUFBSXVELEVBQUVsRCxNQUFGLEdBQVUsQ0FBbEI7QUFDQSxNQUFJcUQsU0FBYSxDQUFDLENBQWxCO0FBQ0EsTUFBSUMsU0FBYSxDQUFDLENBQWxCOztBQUVBLFNBQVFELFVBQVUsQ0FBQyxDQUFaLElBQW1CQyxVQUFVLENBQUMsQ0FBOUIsSUFBcUMzRCxJQUFJLENBQWhELEVBQW9EO0FBQ2xELFFBQUl1RCxFQUFFakMsU0FBRixDQUFZdEIsQ0FBWixFQUFlQSxJQUFHLENBQWxCLEtBQXdCcUMsQ0FBNUIsRUFBK0I7QUFDN0JxQixlQUFTMUQsQ0FBVDtBQUNEO0FBQ0QsUUFBSXVELEVBQUVqQyxTQUFGLENBQVl0QixDQUFaLEVBQWVBLElBQUcsQ0FBbEIsS0FBd0J3RCxDQUE1QixFQUErQjtBQUM3QkcsZUFBUzNELENBQVQ7QUFDRDtBQUNEQSxRQUFJQSxJQUFJLENBQVI7QUFDRDtBQUNELE1BQUkwRCxVQUFVLENBQUMsQ0FBZixFQUFrQjtBQUNoQixRQUFJQyxVQUFVLENBQUMsQ0FBZixFQUFrQjtBQUNoQixhQUFPRCxNQUFQO0FBQ0QsS0FGRCxNQUdLO0FBQ0gsYUFBT0UsS0FBS0MsR0FBTCxDQUFTSCxNQUFULEVBQWlCQyxNQUFqQixDQUFQO0FBQ0Q7QUFDRjs7QUFFRCxNQUFJQSxVQUFVLENBQUMsQ0FBZixFQUFrQjtBQUNoQixXQUFPQSxNQUFQO0FBQ0QsR0FGRCxNQUdLO0FBQ0gsV0FBTyxDQUFDLENBQVI7QUFDRDtBQUNGOztBQUVEL0MsUUFBUUMsR0FBUixDQUNJLG9CQURKLEVBRUl5QyxLQUFLLFVBQUwsRUFBaUIsR0FBakIsRUFBc0IsR0FBdEIsQ0FGSixFQUVnQ04sYUFBYSxFQUFDeEQsS0FBSyxVQUFOLEVBQWtCeUQsU0FBUyxHQUEzQixFQUFnQ0MsU0FBUyxHQUF6QyxFQUFiLENBRmhDOztBQU1BO0FBQ0EsTUFBTVksYUFBYSxDQUFDQyxJQUFELEVBQU9DLFFBQVEsQ0FBQyxDQUFELEVBQUksRUFBSixDQUFmLEVBQXdCQyxRQUFRLE9BQWhDLEtBQTRDO0FBQzdELE1BQUlGLFFBQVFDLE1BQU0sQ0FBTixDQUFSLElBQW9CRCxRQUFRQyxNQUFNLENBQU4sQ0FBaEMsRUFBMEMsT0FBT0MsS0FBUDtBQUMxQyxTQUFPLElBQUlDLEtBQUosQ0FBVSwwQ0FBVixDQUFQO0FBQ0QsQ0FIRDs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0F0RCxRQUFRQyxHQUFSLENBQVlpRCxXQUFXLENBQVgsRUFBYyxDQUFDLENBQUQsRUFBSSxFQUFKLENBQWQsRUFBdUIsT0FBdkIsQ0FBWixHQUErQztBQUMvQ2xELFFBQVFDLEdBQVIsQ0FBWWlELFdBQVcsQ0FBWCxFQUFjLENBQUMsQ0FBRCxFQUFJLEVBQUosQ0FBZCxFQUF1QixPQUF2QixDQUFaLEdBQStDO0FBQy9DbEQsUUFBUUMsR0FBUixDQUFZaUQsV0FBVyxFQUFYLEVBQWUsQ0FBQyxFQUFELEVBQUssRUFBTCxDQUFmLEVBQXlCLE9BQXpCLENBQVosR0FBZ0Q7QUFDaERsRCxRQUFRQyxHQUFSLENBQVlpRCxXQUFXLEVBQVgsRUFBZSxDQUFDLEVBQUQsRUFBSyxHQUFMLENBQWYsRUFBMEIsT0FBMUIsQ0FBWixHQUFpRCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGdldE9ubHlCcmFja2V0cyA9IChzdHIpID0+IHtcbiAgdmFyIHJlZ2V4cCA9IC9bXigpXFxbXFxde30sPD5dL2c7XG4gIHJldHVybiAoc3RyKS5yZXBsYWNlKHJlZ2V4cCwgXCJcIik7XG59O1xudmFyIGFyZUJyYWNrZXRzSW5PcmRlciA9IChzdHIpID0+IHtcbiAgbGV0IGJyYWNrZXRzID0gbmV3IE1hcChcbiAgICAgIFtcbiAgICAgICAgICBbJ10nLCAnWyddLFxuICAgICAgICAgIFsnfScsICd7J10sXG4gICAgICAgICAgWycpJywgJygnXSxcbiAgICAgICAgICBbJz4nLCAnPCddXG4gICAgICBdXG4gICk7XG4gIGxldCBpc0NsZWFuID0gdHJ1ZTtcbiAgY29uc3QgaXRlciA9IChpLCBsZW4sIGlzQ2xlYW5pbmcsIGJyYWNrZXRzLCBjdXIsIGFjYykgPT4ge1xuICAgIGlmIChpID49IGxlbiAmJiAhaXNDbGVhbmluZykgcmV0dXJuIGlzQ2xlYW5pbmcgJiYgIWFjYy5sZW5ndGg7XG4gICAgaWYgKGkgPj0gbGVuKSByZXR1cm4gaXNDbGVhbmluZyAmJiAhYWNjLmxlbmd0aDtcbiAgICBpZiAoYnJhY2tldHMuaGFzKGN1cltpXSkpIHtcbiAgICAgIGxldCBpc0NsZWFuaW5nID0gYWNjLnBvcCgpID09PSBicmFja2V0cy5nZXQoY3VyW2ldKTtcbiAgICAgIHJldHVybiBpdGVyKCsraSwgbGVuLCBpc0NsZWFuaW5nLCBicmFja2V0cywgY3VyLCBhY2MpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhY2MucHVzaChzdHJbaV0pO1xuICAgICAgcmV0dXJuIGl0ZXIoKytpLCBsZW4sIGlzQ2xlYW5pbmcsIGJyYWNrZXRzLCBjdXIsIGFjYyk7XG4gICAgfVxuICB9XG4gIHJldHVybiBpdGVyKDAsIHN0ci5sZW5ndGgsIGlzQ2xlYW4sIGJyYWNrZXRzLCBzdHIsIFtdKVxufTtcbnZhciBjaGVja1N5bnRheCA9IChzdHIpID0+IHtcbiAgY29uc3QgbmV3U3RyID0gZ2V0T25seUJyYWNrZXRzKHN0cik7XG4gIHJldHVybiBhcmVCcmFja2V0c0luT3JkZXIobmV3U3RyKSA/IDAgOiAxO1xufTtcbmNvbnNvbGUubG9nKCdjaGVja1N5bnRheCcpXG5jb25zb2xlLmxvZyAoY2hlY2tTeW50YXgoXCItLS0oKCgoKCgoKSkpKSkpKS0tLS1cIikgPT09IDApO1xuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4IChcIlwiKSA9PT0gMCk7XG5jb25zb2xlLmxvZyAoY2hlY2tTeW50YXggKFwiYmVmb3JlICggbWlkZGxlIFtdKSBhZnRlciBcIikgPT09IDApO1xuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4IChcIikgKFwiKSA9PT0gMSk7XG5jb25zb2xlLmxvZyAoY2hlY2tTeW50YXggKFwifSB7XCIpID09PSAxKTtcbmNvbnNvbGUubG9nIChjaGVja1N5bnRheCAoXCI8PihdKVwiKSA9PT0gMSk7XG5jb25zb2xlLmxvZyAoY2hlY2tTeW50YXggKFwiKCAgWyAgPD4gICgpICBdICA8PiAgKVwiKSA9PT0gMCk7XG5jb25zb2xlLmxvZyAoY2hlY2tTeW50YXggKFwiICAgKCAgICAgIFspXCIpID09PSAxKTtcblxuIiwiJ3VzZSBzdHJpY3QnO1xubGV0IGRzQ291bnQgPSAoLi4uYXJncykgPT4ge1xuICBjb25zdCBbc3RyLCAuLi5yZXN0XSA9IGFyZ3M7XG4gIGNvbnN0IGNvbmNhdGVkU3Vic3RpbmdzID0gcmVzdC5qb2luKCcnKTtcbiAgY29uc3QgaXRlciA9IChjb3VudCwgcG9zaXRpb24sIGN1cnIsIHN1YnN0cmluZykgPT4ge1xuICAgICAgaWYoY3Vyci5pbmRleE9mKHN1YnN0cmluZywgcG9zaXRpb24pID09PSAtMSkgcmV0dXJuIGNvdW50O1xuXG4gICAgICBsZXQgbmV3UG9zaXRpb24gPSBjdXJyLmluZGV4T2Yoc3Vic3RyaW5nLCBwb3NpdGlvbik7XG4gICAgICByZXR1cm4gaXRlcigrK2NvdW50LCArK25ld1Bvc2l0aW9uLCBjdXJyLCBzdWJzdHJpbmcpO1xuICB9XG5cbiAgcmV0dXJuIGl0ZXIoMCwgMCwgc3RyLnRvTG93ZXJDYXNlKCksIGNvbmNhdGVkU3Vic3RpbmdzLnRvTG93ZXJDYXNlKCkpXG5cblxufVxuY29uc29sZS5sb2coJ2RzQ291bnQnKTtcbnRyeSB7XG4gIHRlc3QoZHNDb3VudCwgWydhYl9fX2FiX18nLCAnYScsICdiJ10sIDIpO1xuICB0ZXN0KGRzQ291bnQsIFsnX19fY2RfX19fJywgJ2MnLCAnZCddLCAxKTtcbiAgdGVzdChkc0NvdW50LCBbJ2RlX19fX19fXycsICdkJywgJ2UnXSwgMSk7XG4gIHRlc3QoZHNDb3VudCwgWycxMl8xMl9fMTInLCAnMScsICcyJ10sIDMpO1xuICB0ZXN0KGRzQ291bnQsIFsnX2JhX19fX19fJywgJ2EnLCAnYiddLCAwKTtcbiAgdGVzdChkc0NvdW50LCBbJ19hX19iX19fXycsICdhJywgJ2InXSwgMCk7XG4gIHRlc3QoZHNDb3VudCwgWyctYWIt0LBiLWFiJywgJ2EnLCAnYiddLCAyKTtcbiAgdGVzdChkc0NvdW50LCBbJ2FBYScsICdhJywgJ2EnXSwgMik7XG4gIGNvbnNvbGUuaW5mbyhcIkNvbmdyYXR1bGF0aW9ucyEgQWxsIHRlc3RzIHN1Y2Nlc3MgcGFzc2VkLlwiKTtcbn0gY2F0Y2goZSkge1xuICBjb25zb2xlLmVycm9yKGUpO1xufVxuXG4vLyDQn9GA0L7RgdGC0LDRjyDRhNGD0L3QutGG0LjRjyDRgtC10YHRgtC40YDQvtCy0LDQvdC40Y9cblxuZnVuY3Rpb24gdGVzdChjYWxsLCBhcmdzLCBjb3VudCwgbikge1xuICBsZXQgciA9IChjYWxsLmFwcGx5KG4sIGFyZ3MpID09PSBjb3VudCk7XG4gIGNvbnNvbGUuYXNzZXJ0KHIsIGBGaW5kZWQgaXRlbXMgY291bnQ6ICR7Y291bnR9YCk7XG4gIGlmICghcikgdGhyb3cgXCJUZXN0IGZhaWxlZCFcIjtcbn1cblxuIiwiY29uc29sZS5sb2coJ3BhcnNlVXJsJyk7XG5sZXQgcGFyc2VVcmwgPSAodXJsKSA9PiB7XG4gIGxldCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICBhLmhyZWYgPSB1cmw7XG4gIHJldHVybiBuZXcgTWFwKFtcbiAgICAgIFsnaHJlZicsIHVybF0sXG4gICAgICBbJ3Byb3RvY29sJywgYS5wcm90b2NvbF0sXG4gICAgICBbJ2hvc3RuYW1lJywgYS5ob3N0bmFtZV0sXG4gICAgICBbJ2hhc2gnLCBhLmhhc2hdLFxuICAgICAgWydwb3J0JywgYS5wb3J0XSxcbiAgICAgIFsnaG9zdCcsIGEuaG9zdF0sXG4gICAgICBbJ3BhdGhuYW1lJywgYS5wYXRobmFtZV0sXG4gICAgICBbJ29yaWdpbicsIGEub3JpZ2luXSxcbiAgXSk7XG59XG5cbmxldCBhID0gcGFyc2VVcmwoJ2h0dHA6Ly90dXR1LnJ1OjgwODAvZG8vYW55LnBocD9hPTEmYltdPWEmYltdPWIjZm9vJyk7XG5cbmNvbnNvbGUubG9nKGEuZ2V0KCdocmVmJykpO1xuY29uc29sZS5sb2coYS5nZXQoJ2hhc2gnKSk7XG5jb25zb2xlLmxvZyhhLmdldCgncG9ydCcpKTtcbmNvbnNvbGUubG9nKGEuZ2V0KCdob3N0JykpO1xuY29uc29sZS5sb2coYS5nZXQoJ3Byb3RvY29sJykpO1xuY29uc29sZS5sb2coYS5nZXQoJ2hvc3RuYW1lJykpO1xuY29uc29sZS5sb2coYS5nZXQoJ3BhdGhuYW1lJykpO1xuY29uc29sZS5sb2coYS5nZXQoJ29yaWdpbicpKTtcbiIsIi8v0JfQsNC00LDRh9CwICMxXG5jb25zdCBnZXRTdWJzdHJpbmcgPSAoe3N0ciwgc3ViU3RyMSwgc3ViU3RyMn0pID0+IHtcbiAgaWYgKHN0ciA9PT0gJycpIHJldHVybiAtMTtcbiAgbGV0IHN1YlN0clBvc2l0aW9uMSA9IHN0ci5sYXN0SW5kZXhPZihzdWJTdHIxLCBzdHIubGVuZ3RoIC0gMSk7XG4gIGxldCBzdWJTdHJQb3NpdGlvbjIgPSBzdHIubGFzdEluZGV4T2Yoc3ViU3RyMiwgc3RyLmxlbmd0aCAtIDEpO1xuXG4gIHJldHVybiBzdWJTdHJQb3NpdGlvbjEgIT09IC0xID8gc3ViU3RyUG9zaXRpb24xIDpcbiAgICAgICAgIHN1YlN0clBvc2l0aW9uMiAhPT0gLTEgPyBzdWJTdHJQb3NpdGlvbjIgOlxuICAgICAgICAgc3ViU3RyUG9zaXRpb24xID09PSBzdWJTdHJQb3NpdGlvbjIgPyBzdWJTdHJQb3NpdGlvbjEgOiAtMTtcblxufVxuXG5mdW5jdGlvbiBmdW5jKHMsIGEsIGIpIHtcblxuICBpZiAocy5tYXRjaCgvXiQvKSkge1xuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIHZhciBpID0gcy5sZW5ndGggLTE7XG4gIHZhciBhSW5kZXggPSAgICAgLTE7XG4gIHZhciBiSW5kZXggPSAgICAgLTE7XG5cbiAgd2hpbGUgKChhSW5kZXggPT0gLTEpICYmIChiSW5kZXggPT0gLTEpICYmIChpID4gMCkpIHtcbiAgICBpZiAocy5zdWJzdHJpbmcoaSwgaSArMSkgPT0gYSkge1xuICAgICAgYUluZGV4ID0gaTtcbiAgICB9XG4gICAgaWYgKHMuc3Vic3RyaW5nKGksIGkgKzEpID09IGIpIHtcbiAgICAgIGJJbmRleCA9IGk7XG4gICAgfVxuICAgIGkgPSBpIC0gMTtcbiAgfVxuICBpZiAoYUluZGV4ICE9IC0xKSB7XG4gICAgaWYgKGJJbmRleCA9PSAtMSkge1xuICAgICAgcmV0dXJuIGFJbmRleDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICByZXR1cm4gTWF0aC5tYXgoYUluZGV4LCBiSW5kZXgpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChiSW5kZXggIT0gLTEpIHtcbiAgICByZXR1cm4gYkluZGV4O1xuICB9XG4gIGVsc2Uge1xuICAgIHJldHVybiAtMTtcbiAgfVxufVxuXG5jb25zb2xlLmxvZyhcbiAgICAnUmVmYWN0b3JpbmcgdGFzayAxJyxcbiAgICBmdW5jKCcxMjM0NTU2MCcsICcwJywgJzAnKSwgZ2V0U3Vic3RyaW5nKHtzdHI6ICcxMjM0NTU2MCcsIHN1YlN0cjE6ICcwJywgc3ViU3RyMjogJzAnfSlcbilcblxuXG4vL9CX0LDQtNCw0YfQsCAyXG5jb25zdCBkcmF3UmF0aW5nID0gKHZvdGUsIHJhbmdlID0gWzAsIDIwXSwgc3RhcnMgPSAn4piF4piG4piG4piG4piGJykgPT4ge1xuICBpZiAodm90ZSA+PSByYW5nZVswXSAmJiB2b3RlIDw9IHJhbmdlWzFdKSByZXR1cm4gc3RhcnM7XG4gIHJldHVybiBuZXcgRXJyb3IoJ9Cn0YLQviDRgtC+INC/0L7RiNC70L4g0L3QtSDRgtCw0LosINC/0YDQvtCy0LXRgNGM0YLQtSDQsNGA0LPRg9C80LXQvdGC0YsnKTtcbn1cblxuLy9mdW5jdGlvbiBkcmF3UmF0aW5nKHZvdGUpIHtcbi8vICBpZiAodm90ZSA+PSAwICYmIHZvdGUgPD0gMjApIHtcbi8vICAgIHJldHVybiAn4piF4piG4piG4piG4piGJztcbi8vICB9XG4vLyAgZWxzZSBpZiAodm90ZSA+IDIwICYmIHZvdGUgPD0gNDApIHtcbi8vICAgIHJldHVybiAn4piF4piF4piG4piG4piGJztcbi8vICB9XG4vLyAgZWxzZSBpZiAodm90ZSA+IDQwICYmIHZvdGUgPD0gNjApIHtcbi8vICAgIHJldHVybiAn4piF4piF4piF4piG4piGJztcbi8vICB9XG4vLyAgZWxzZSBpZiAodm90ZSA+IDYwICYmIHZvdGUgPD0gODApIHtcbi8vICAgIHJldHVybiAn4piF4piF4piF4piF4piGJztcbi8vICB9XG4vLyAgZWxzZSBpZiAodm90ZSA+IDgwICYmIHZvdGUgPD0gMTAwKSB7XG4vLyAgICByZXR1cm4gJ+KYheKYheKYheKYheKYhSc7XG4vLyAgfVxuLy99XG5cbi8vINCf0YDQvtCy0LXRgNC60LAg0YDQsNCx0L7RgtGLINGA0LXQt9GD0LvRjNGC0LDRgtCwXG5jb25zb2xlLmxvZyhkcmF3UmF0aW5nKDAsIFswLCAyMF0sICfimIXimIbimIbimIbimIYnKSApOyAvLyDimIXimIbimIbimIbimIZcbmNvbnNvbGUubG9nKGRyYXdSYXRpbmcoMSwgWzAsIDIwXSwgJ+KYheKYhuKYhuKYhuKYhicpICk7IC8vIOKYheKYhuKYhuKYhuKYhlxuY29uc29sZS5sb2coZHJhd1JhdGluZyg1MCwgWzQwLCA2MF0sICfimIXimIXimIXimIbimIYnKSk7IC8vIOKYheKYheKYheKYhuKYhlxuY29uc29sZS5sb2coZHJhd1JhdGluZyg5OSwgWzgwLCAxMDBdLCAn4piF4piF4piF4piF4piFJykpOyAvLyDimIXimIXimIXimIXimIUiXX0=
