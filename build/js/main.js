'use strict';

var getOnlyBrackets = str => {
  var regexp = /[^()\[\]{},<>]/g;
  return str.replace(regexp, "");
};
var areBracketsInOrder = str => {
  let brackets = new Map([[']', '['], ['}', '{'], [')', '('], ['>', '<']]);
  let isClean = true;
  const iter = (i, len, isCleaning, brackets, cur, acc) => {
    if (i >= len && !isCleaning) return isCleaning && !acc.length;
    if (i >= len) return isCleaning && !acc.length;
    if (brackets.has(cur[i])) {
      let isCleaning = acc.pop() === brackets.get(cur[i]);
      return iter(++i, len, isCleaning, brackets, cur, acc);
    } else {
      acc.push(str[i]);
      return iter(++i, len, isCleaning, brackets, cur, acc);
    }
  };
  return iter(0, str.length, isClean, brackets, str, []);
};
var checkSyntax = str => {
  const newStr = getOnlyBrackets(str);
  return areBracketsInOrder(newStr) ? 0 : 1;
};
console.log('checkSyntax');
console.log(checkSyntax("---((((((()))))))----") === 0);
console.log(checkSyntax("") === 0);
console.log(checkSyntax("before ( middle []) after ") === 0);
console.log(checkSyntax(") (") === 1);
console.log(checkSyntax("} {") === 1);
console.log(checkSyntax("<>(])") === 1);
console.log(checkSyntax("(  [  <>  ()  ]  <>  )") === 0);
console.log(checkSyntax("   (      [)") === 1);
'use strict';

let dsCount = (...args) => {
  const [str, ...rest] = args;
  const concatedSubstings = rest.join('');
  const iter = (count, position, curr, substring) => {
    if (curr.indexOf(substring, position) === -1) return count;

    let newPosition = curr.indexOf(substring, position);
    return iter(++count, ++newPosition, curr, substring);
  };

  return iter(0, 0, str.toLowerCase(), concatedSubstings.toLowerCase());
};
console.log('dsCount');
try {
  test(dsCount, ['ab___ab__', 'a', 'b'], 2);
  test(dsCount, ['___cd____', 'c', 'd'], 1);
  test(dsCount, ['de_______', 'd', 'e'], 1);
  test(dsCount, ['12_12__12', '1', '2'], 3);
  test(dsCount, ['_ba______', 'a', 'b'], 0);
  test(dsCount, ['_a__b____', 'a', 'b'], 0);
  test(dsCount, ['-ab-аb-ab', 'a', 'b'], 2);
  test(dsCount, ['aAa', 'a', 'a'], 2);
  console.info("Congratulations! All tests success passed.");
} catch (e) {
  console.error(e);
}

// Простая функция тестирования

function test(call, args, count, n) {
  let r = call.apply(n, args) === count;
  console.assert(r, `Finded items count: ${count}`);
  if (!r) throw "Test failed!";
}
console.log('parseUrl');
let parseUrl = url => {
  let a = document.createElement('a');
  a.href = url;
  return a;
};

let a = parseUrl('http://tutu.ru:8080/do/any.php?a=1&b[]=a&b[]=b#foo');

console.log(a.href);
console.log(a.hash);
console.log(a.port);
console.log(a.host);
console.log(a.protocol);
console.log(a.hostname);
console.log(a.pathname);
console.log(a.origin);
//Задача #1
const getSubstring = ({ str, subStr1, subStr2 }) => {
  if (str === '') return -1;
  let subStrPosition1 = str.lastIndexOf(subStr1, str.length - 1);
  let subStrPosition2 = str.lastIndexOf(subStr2, str.length - 1);

  return subStrPosition1 !== -1 ? subStrPosition1 : subStrPosition2 !== -1 ? subStrPosition2 : subStrPosition1 === subStrPosition2 ? subStrPosition1 : -1;
};

function func(s, a, b) {

  if (s.match(/^$/)) {
    return -1;
  }

  var i = s.length - 1;
  var aIndex = -1;
  var bIndex = -1;

  while (aIndex == -1 && bIndex == -1 && i > 0) {
    if (s.substring(i, i + 1) == a) {
      aIndex = i;
    }
    if (s.substring(i, i + 1) == b) {
      bIndex = i;
    }
    i = i - 1;
  }
  if (aIndex != -1) {
    if (bIndex == -1) {
      return aIndex;
    } else {
      return Math.max(aIndex, bIndex);
    }
  }

  if (bIndex != -1) {
    return bIndex;
  } else {
    return -1;
  }
}

console.log('Refactoring task 1', func('12345560', '0', '0'), getSubstring({ str: '12345560', subStr1: '0', subStr2: '0' }));

//Задача 2
const drawRating = (vote, range = [0, 20, 40, 60, 80, 100], stars = '★☆☆☆☆') => {
  let returnedValue;
  for (let i = 0; i < range.length - 1; i++) {
    if (vote >= range[i] && vote <= range[i + 1]) {
      returnedValue = stars;
      break;
    }
  }
  return returnedValue;
};
let range = [0, 20, 40, 60, 80, 100];

// Проверка работы результата
console.log(drawRating(0, range, '★☆☆☆☆'));
console.log(drawRating(1, range, '★☆☆☆☆'));
console.log(drawRating(50, range, '★★★☆☆'));
console.log(drawRating(99, range, '★★★★★'));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrU3ludGF4LmpzIiwiZHNDb3VudC5qcyIsInBhcnNlVXJsLmpzIiwicmVmYWN0b3JpbmcuanMiXSwibmFtZXMiOlsiZ2V0T25seUJyYWNrZXRzIiwic3RyIiwicmVnZXhwIiwicmVwbGFjZSIsImFyZUJyYWNrZXRzSW5PcmRlciIsImJyYWNrZXRzIiwiTWFwIiwiaXNDbGVhbiIsIml0ZXIiLCJpIiwibGVuIiwiaXNDbGVhbmluZyIsImN1ciIsImFjYyIsImxlbmd0aCIsImhhcyIsInBvcCIsImdldCIsInB1c2giLCJjaGVja1N5bnRheCIsIm5ld1N0ciIsImNvbnNvbGUiLCJsb2ciLCJkc0NvdW50IiwiYXJncyIsInJlc3QiLCJjb25jYXRlZFN1YnN0aW5ncyIsImpvaW4iLCJjb3VudCIsInBvc2l0aW9uIiwiY3VyciIsInN1YnN0cmluZyIsImluZGV4T2YiLCJuZXdQb3NpdGlvbiIsInRvTG93ZXJDYXNlIiwidGVzdCIsImluZm8iLCJlIiwiZXJyb3IiLCJjYWxsIiwibiIsInIiLCJhcHBseSIsImFzc2VydCIsInBhcnNlVXJsIiwidXJsIiwiYSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJoYXNoIiwicG9ydCIsImhvc3QiLCJwcm90b2NvbCIsImhvc3RuYW1lIiwicGF0aG5hbWUiLCJvcmlnaW4iLCJnZXRTdWJzdHJpbmciLCJzdWJTdHIxIiwic3ViU3RyMiIsInN1YlN0clBvc2l0aW9uMSIsImxhc3RJbmRleE9mIiwic3ViU3RyUG9zaXRpb24yIiwiZnVuYyIsInMiLCJiIiwibWF0Y2giLCJhSW5kZXgiLCJiSW5kZXgiLCJNYXRoIiwibWF4IiwiZHJhd1JhdGluZyIsInZvdGUiLCJyYW5nZSIsInN0YXJzIiwicmV0dXJuZWRWYWx1ZSJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBQ0EsSUFBSUEsa0JBQW1CQyxHQUFELElBQVM7QUFDN0IsTUFBSUMsU0FBUyxpQkFBYjtBQUNBLFNBQVFELEdBQUQsQ0FBTUUsT0FBTixDQUFjRCxNQUFkLEVBQXNCLEVBQXRCLENBQVA7QUFDRCxDQUhEO0FBSUEsSUFBSUUscUJBQXNCSCxHQUFELElBQVM7QUFDaEMsTUFBSUksV0FBVyxJQUFJQyxHQUFKLENBQ1gsQ0FDSSxDQUFDLEdBQUQsRUFBTSxHQUFOLENBREosRUFFSSxDQUFDLEdBQUQsRUFBTSxHQUFOLENBRkosRUFHSSxDQUFDLEdBQUQsRUFBTSxHQUFOLENBSEosRUFJSSxDQUFDLEdBQUQsRUFBTSxHQUFOLENBSkosQ0FEVyxDQUFmO0FBUUEsTUFBSUMsVUFBVSxJQUFkO0FBQ0EsUUFBTUMsT0FBTyxDQUFDQyxDQUFELEVBQUlDLEdBQUosRUFBU0MsVUFBVCxFQUFxQk4sUUFBckIsRUFBK0JPLEdBQS9CLEVBQW9DQyxHQUFwQyxLQUE0QztBQUN2RCxRQUFJSixLQUFLQyxHQUFMLElBQVksQ0FBQ0MsVUFBakIsRUFBNkIsT0FBT0EsY0FBYyxDQUFDRSxJQUFJQyxNQUExQjtBQUM3QixRQUFJTCxLQUFLQyxHQUFULEVBQWMsT0FBT0MsY0FBYyxDQUFDRSxJQUFJQyxNQUExQjtBQUNkLFFBQUlULFNBQVNVLEdBQVQsQ0FBYUgsSUFBSUgsQ0FBSixDQUFiLENBQUosRUFBMEI7QUFDeEIsVUFBSUUsYUFBYUUsSUFBSUcsR0FBSixPQUFjWCxTQUFTWSxHQUFULENBQWFMLElBQUlILENBQUosQ0FBYixDQUEvQjtBQUNBLGFBQU9ELEtBQUssRUFBRUMsQ0FBUCxFQUFVQyxHQUFWLEVBQWVDLFVBQWYsRUFBMkJOLFFBQTNCLEVBQXFDTyxHQUFyQyxFQUEwQ0MsR0FBMUMsQ0FBUDtBQUNELEtBSEQsTUFHTztBQUNMQSxVQUFJSyxJQUFKLENBQVNqQixJQUFJUSxDQUFKLENBQVQ7QUFDQSxhQUFPRCxLQUFLLEVBQUVDLENBQVAsRUFBVUMsR0FBVixFQUFlQyxVQUFmLEVBQTJCTixRQUEzQixFQUFxQ08sR0FBckMsRUFBMENDLEdBQTFDLENBQVA7QUFDRDtBQUNGLEdBVkQ7QUFXQSxTQUFPTCxLQUFLLENBQUwsRUFBUVAsSUFBSWEsTUFBWixFQUFvQlAsT0FBcEIsRUFBNkJGLFFBQTdCLEVBQXVDSixHQUF2QyxFQUE0QyxFQUE1QyxDQUFQO0FBQ0QsQ0F0QkQ7QUF1QkEsSUFBSWtCLGNBQWVsQixHQUFELElBQVM7QUFDekIsUUFBTW1CLFNBQVNwQixnQkFBZ0JDLEdBQWhCLENBQWY7QUFDQSxTQUFPRyxtQkFBbUJnQixNQUFuQixJQUE2QixDQUE3QixHQUFpQyxDQUF4QztBQUNELENBSEQ7QUFJQUMsUUFBUUMsR0FBUixDQUFZLGFBQVo7QUFDQUQsUUFBUUMsR0FBUixDQUFhSCxZQUFZLHVCQUFaLE1BQXlDLENBQXREO0FBQ0FFLFFBQVFDLEdBQVIsQ0FBYUgsWUFBYSxFQUFiLE1BQXFCLENBQWxDO0FBQ0FFLFFBQVFDLEdBQVIsQ0FBYUgsWUFBYSw0QkFBYixNQUErQyxDQUE1RDtBQUNBRSxRQUFRQyxHQUFSLENBQWFILFlBQWEsS0FBYixNQUF3QixDQUFyQztBQUNBRSxRQUFRQyxHQUFSLENBQWFILFlBQWEsS0FBYixNQUF3QixDQUFyQztBQUNBRSxRQUFRQyxHQUFSLENBQWFILFlBQWEsT0FBYixNQUEwQixDQUF2QztBQUNBRSxRQUFRQyxHQUFSLENBQWFILFlBQWEsd0JBQWIsTUFBMkMsQ0FBeEQ7QUFDQUUsUUFBUUMsR0FBUixDQUFhSCxZQUFhLGNBQWIsTUFBaUMsQ0FBOUM7QUN4Q0E7O0FBQ0EsSUFBSUksVUFBVSxDQUFDLEdBQUdDLElBQUosS0FBYTtBQUN6QixRQUFNLENBQUN2QixHQUFELEVBQU0sR0FBR3dCLElBQVQsSUFBaUJELElBQXZCO0FBQ0EsUUFBTUUsb0JBQW9CRCxLQUFLRSxJQUFMLENBQVUsRUFBVixDQUExQjtBQUNBLFFBQU1uQixPQUFPLENBQUNvQixLQUFELEVBQVFDLFFBQVIsRUFBa0JDLElBQWxCLEVBQXdCQyxTQUF4QixLQUFzQztBQUMvQyxRQUFHRCxLQUFLRSxPQUFMLENBQWFELFNBQWIsRUFBd0JGLFFBQXhCLE1BQXNDLENBQUMsQ0FBMUMsRUFBNkMsT0FBT0QsS0FBUDs7QUFFN0MsUUFBSUssY0FBY0gsS0FBS0UsT0FBTCxDQUFhRCxTQUFiLEVBQXdCRixRQUF4QixDQUFsQjtBQUNBLFdBQU9yQixLQUFLLEVBQUVvQixLQUFQLEVBQWMsRUFBRUssV0FBaEIsRUFBNkJILElBQTdCLEVBQW1DQyxTQUFuQyxDQUFQO0FBQ0gsR0FMRDs7QUFPQSxTQUFPdkIsS0FBSyxDQUFMLEVBQVEsQ0FBUixFQUFXUCxJQUFJaUMsV0FBSixFQUFYLEVBQThCUixrQkFBa0JRLFdBQWxCLEVBQTlCLENBQVA7QUFHRCxDQWJEO0FBY0FiLFFBQVFDLEdBQVIsQ0FBWSxTQUFaO0FBQ0EsSUFBSTtBQUNGYSxPQUFLWixPQUFMLEVBQWMsQ0FBQyxXQUFELEVBQWMsR0FBZCxFQUFtQixHQUFuQixDQUFkLEVBQXVDLENBQXZDO0FBQ0FZLE9BQUtaLE9BQUwsRUFBYyxDQUFDLFdBQUQsRUFBYyxHQUFkLEVBQW1CLEdBQW5CLENBQWQsRUFBdUMsQ0FBdkM7QUFDQVksT0FBS1osT0FBTCxFQUFjLENBQUMsV0FBRCxFQUFjLEdBQWQsRUFBbUIsR0FBbkIsQ0FBZCxFQUF1QyxDQUF2QztBQUNBWSxPQUFLWixPQUFMLEVBQWMsQ0FBQyxXQUFELEVBQWMsR0FBZCxFQUFtQixHQUFuQixDQUFkLEVBQXVDLENBQXZDO0FBQ0FZLE9BQUtaLE9BQUwsRUFBYyxDQUFDLFdBQUQsRUFBYyxHQUFkLEVBQW1CLEdBQW5CLENBQWQsRUFBdUMsQ0FBdkM7QUFDQVksT0FBS1osT0FBTCxFQUFjLENBQUMsV0FBRCxFQUFjLEdBQWQsRUFBbUIsR0FBbkIsQ0FBZCxFQUF1QyxDQUF2QztBQUNBWSxPQUFLWixPQUFMLEVBQWMsQ0FBQyxXQUFELEVBQWMsR0FBZCxFQUFtQixHQUFuQixDQUFkLEVBQXVDLENBQXZDO0FBQ0FZLE9BQUtaLE9BQUwsRUFBYyxDQUFDLEtBQUQsRUFBUSxHQUFSLEVBQWEsR0FBYixDQUFkLEVBQWlDLENBQWpDO0FBQ0FGLFVBQVFlLElBQVIsQ0FBYSw0Q0FBYjtBQUNELENBVkQsQ0FVRSxPQUFNQyxDQUFOLEVBQVM7QUFDVGhCLFVBQVFpQixLQUFSLENBQWNELENBQWQ7QUFDRDs7QUFFRDs7QUFFQSxTQUFTRixJQUFULENBQWNJLElBQWQsRUFBb0JmLElBQXBCLEVBQTBCSSxLQUExQixFQUFpQ1ksQ0FBakMsRUFBb0M7QUFDbEMsTUFBSUMsSUFBS0YsS0FBS0csS0FBTCxDQUFXRixDQUFYLEVBQWNoQixJQUFkLE1BQXdCSSxLQUFqQztBQUNBUCxVQUFRc0IsTUFBUixDQUFlRixDQUFmLEVBQW1CLHVCQUFzQmIsS0FBTSxFQUEvQztBQUNBLE1BQUksQ0FBQ2EsQ0FBTCxFQUFRLE1BQU0sY0FBTjtBQUNUO0FDcENEcEIsUUFBUUMsR0FBUixDQUFZLFVBQVo7QUFDQSxJQUFJc0IsV0FBWUMsR0FBRCxJQUFTO0FBQ3RCLE1BQUlDLElBQUlDLFNBQVNDLGFBQVQsQ0FBd0IsR0FBeEIsQ0FBUjtBQUNBRixJQUFFRyxJQUFGLEdBQVNKLEdBQVQ7QUFDQSxTQUFPQyxDQUFQO0FBQ0QsQ0FKRDs7QUFNQSxJQUFJQSxJQUFJRixTQUFTLG9EQUFULENBQVI7O0FBRUF2QixRQUFRQyxHQUFSLENBQVl3QixFQUFFRyxJQUFkO0FBQ0E1QixRQUFRQyxHQUFSLENBQVl3QixFQUFFSSxJQUFkO0FBQ0E3QixRQUFRQyxHQUFSLENBQVl3QixFQUFFSyxJQUFkO0FBQ0E5QixRQUFRQyxHQUFSLENBQVl3QixFQUFFTSxJQUFkO0FBQ0EvQixRQUFRQyxHQUFSLENBQVl3QixFQUFFTyxRQUFkO0FBQ0FoQyxRQUFRQyxHQUFSLENBQVl3QixFQUFFUSxRQUFkO0FBQ0FqQyxRQUFRQyxHQUFSLENBQVl3QixFQUFFUyxRQUFkO0FBQ0FsQyxRQUFRQyxHQUFSLENBQVl3QixFQUFFVSxNQUFkO0FDaEJBO0FBQ0EsTUFBTUMsZUFBZSxDQUFDLEVBQUN4RCxHQUFELEVBQU15RCxPQUFOLEVBQWVDLE9BQWYsRUFBRCxLQUE2QjtBQUNoRCxNQUFJMUQsUUFBUSxFQUFaLEVBQWdCLE9BQU8sQ0FBQyxDQUFSO0FBQ2hCLE1BQUkyRCxrQkFBa0IzRCxJQUFJNEQsV0FBSixDQUFnQkgsT0FBaEIsRUFBeUJ6RCxJQUFJYSxNQUFKLEdBQWEsQ0FBdEMsQ0FBdEI7QUFDQSxNQUFJZ0Qsa0JBQWtCN0QsSUFBSTRELFdBQUosQ0FBZ0JGLE9BQWhCLEVBQXlCMUQsSUFBSWEsTUFBSixHQUFhLENBQXRDLENBQXRCOztBQUVBLFNBQU84QyxvQkFBb0IsQ0FBQyxDQUFyQixHQUF5QkEsZUFBekIsR0FDQUUsb0JBQW9CLENBQUMsQ0FBckIsR0FBeUJBLGVBQXpCLEdBQ0FGLG9CQUFvQkUsZUFBcEIsR0FBc0NGLGVBQXRDLEdBQXdELENBQUMsQ0FGaEU7QUFJRCxDQVREOztBQVdBLFNBQVNHLElBQVQsQ0FBY0MsQ0FBZCxFQUFpQmxCLENBQWpCLEVBQW9CbUIsQ0FBcEIsRUFBdUI7O0FBRXJCLE1BQUlELEVBQUVFLEtBQUYsQ0FBUSxJQUFSLENBQUosRUFBbUI7QUFDakIsV0FBTyxDQUFDLENBQVI7QUFDRDs7QUFFRCxNQUFJekQsSUFBSXVELEVBQUVsRCxNQUFGLEdBQVUsQ0FBbEI7QUFDQSxNQUFJcUQsU0FBYSxDQUFDLENBQWxCO0FBQ0EsTUFBSUMsU0FBYSxDQUFDLENBQWxCOztBQUVBLFNBQVFELFVBQVUsQ0FBQyxDQUFaLElBQW1CQyxVQUFVLENBQUMsQ0FBOUIsSUFBcUMzRCxJQUFJLENBQWhELEVBQW9EO0FBQ2xELFFBQUl1RCxFQUFFakMsU0FBRixDQUFZdEIsQ0FBWixFQUFlQSxJQUFHLENBQWxCLEtBQXdCcUMsQ0FBNUIsRUFBK0I7QUFDN0JxQixlQUFTMUQsQ0FBVDtBQUNEO0FBQ0QsUUFBSXVELEVBQUVqQyxTQUFGLENBQVl0QixDQUFaLEVBQWVBLElBQUcsQ0FBbEIsS0FBd0J3RCxDQUE1QixFQUErQjtBQUM3QkcsZUFBUzNELENBQVQ7QUFDRDtBQUNEQSxRQUFJQSxJQUFJLENBQVI7QUFDRDtBQUNELE1BQUkwRCxVQUFVLENBQUMsQ0FBZixFQUFrQjtBQUNoQixRQUFJQyxVQUFVLENBQUMsQ0FBZixFQUFrQjtBQUNoQixhQUFPRCxNQUFQO0FBQ0QsS0FGRCxNQUdLO0FBQ0gsYUFBT0UsS0FBS0MsR0FBTCxDQUFTSCxNQUFULEVBQWlCQyxNQUFqQixDQUFQO0FBQ0Q7QUFDRjs7QUFFRCxNQUFJQSxVQUFVLENBQUMsQ0FBZixFQUFrQjtBQUNoQixXQUFPQSxNQUFQO0FBQ0QsR0FGRCxNQUdLO0FBQ0gsV0FBTyxDQUFDLENBQVI7QUFDRDtBQUNGOztBQUVEL0MsUUFBUUMsR0FBUixDQUNJLG9CQURKLEVBRUl5QyxLQUFLLFVBQUwsRUFBaUIsR0FBakIsRUFBc0IsR0FBdEIsQ0FGSixFQUVnQ04sYUFBYSxFQUFDeEQsS0FBSyxVQUFOLEVBQWtCeUQsU0FBUyxHQUEzQixFQUFnQ0MsU0FBUyxHQUF6QyxFQUFiLENBRmhDOztBQU1BO0FBQ0EsTUFBTVksYUFBYSxDQUFDQyxJQUFELEVBQU9DLFFBQVEsQ0FBQyxDQUFELEVBQUksRUFBSixFQUFRLEVBQVIsRUFBWSxFQUFaLEVBQWdCLEVBQWhCLEVBQW9CLEdBQXBCLENBQWYsRUFBeUNDLFFBQVEsT0FBakQsS0FBNkQ7QUFDOUUsTUFBSUMsYUFBSjtBQUNBLE9BQUssSUFBSWxFLElBQUksQ0FBYixFQUFnQkEsSUFBSWdFLE1BQU0zRCxNQUFOLEdBQWUsQ0FBbkMsRUFBc0NMLEdBQXRDLEVBQTJDO0FBQ3hDLFFBQUkrRCxRQUFRQyxNQUFNaEUsQ0FBTixDQUFSLElBQW9CK0QsUUFBUUMsTUFBTWhFLElBQUksQ0FBVixDQUFoQyxFQUE4QztBQUM1Q2tFLHNCQUFnQkQsS0FBaEI7QUFDQTtBQUNEO0FBQ0g7QUFDRCxTQUFPQyxhQUFQO0FBQ0QsQ0FURDtBQVVBLElBQUlGLFFBQVEsQ0FBQyxDQUFELEVBQUksRUFBSixFQUFRLEVBQVIsRUFBWSxFQUFaLEVBQWdCLEVBQWhCLEVBQW9CLEdBQXBCLENBQVo7O0FBRUE7QUFDQXBELFFBQVFDLEdBQVIsQ0FBWWlELFdBQVcsQ0FBWCxFQUFjRSxLQUFkLEVBQXFCLE9BQXJCLENBQVo7QUFDQXBELFFBQVFDLEdBQVIsQ0FBWWlELFdBQVcsQ0FBWCxFQUFjRSxLQUFkLEVBQXFCLE9BQXJCLENBQVo7QUFDQXBELFFBQVFDLEdBQVIsQ0FBWWlELFdBQVcsRUFBWCxFQUFlRSxLQUFmLEVBQXNCLE9BQXRCLENBQVo7QUFDQXBELFFBQVFDLEdBQVIsQ0FBWWlELFdBQVcsRUFBWCxFQUFlRSxLQUFmLEVBQXNCLE9BQXRCLENBQVoiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbnZhciBnZXRPbmx5QnJhY2tldHMgPSAoc3RyKSA9PiB7XG4gIHZhciByZWdleHAgPSAvW14oKVxcW1xcXXt9LDw+XS9nO1xuICByZXR1cm4gKHN0cikucmVwbGFjZShyZWdleHAsIFwiXCIpO1xufTtcbnZhciBhcmVCcmFja2V0c0luT3JkZXIgPSAoc3RyKSA9PiB7XG4gIGxldCBicmFja2V0cyA9IG5ldyBNYXAoXG4gICAgICBbXG4gICAgICAgICAgWyddJywgJ1snXSxcbiAgICAgICAgICBbJ30nLCAneyddLFxuICAgICAgICAgIFsnKScsICcoJ10sXG4gICAgICAgICAgWyc+JywgJzwnXVxuICAgICAgXVxuICApO1xuICBsZXQgaXNDbGVhbiA9IHRydWU7XG4gIGNvbnN0IGl0ZXIgPSAoaSwgbGVuLCBpc0NsZWFuaW5nLCBicmFja2V0cywgY3VyLCBhY2MpID0+IHtcbiAgICBpZiAoaSA+PSBsZW4gJiYgIWlzQ2xlYW5pbmcpIHJldHVybiBpc0NsZWFuaW5nICYmICFhY2MubGVuZ3RoO1xuICAgIGlmIChpID49IGxlbikgcmV0dXJuIGlzQ2xlYW5pbmcgJiYgIWFjYy5sZW5ndGg7XG4gICAgaWYgKGJyYWNrZXRzLmhhcyhjdXJbaV0pKSB7XG4gICAgICBsZXQgaXNDbGVhbmluZyA9IGFjYy5wb3AoKSA9PT0gYnJhY2tldHMuZ2V0KGN1cltpXSk7XG4gICAgICByZXR1cm4gaXRlcigrK2ksIGxlbiwgaXNDbGVhbmluZywgYnJhY2tldHMsIGN1ciwgYWNjKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWNjLnB1c2goc3RyW2ldKTtcbiAgICAgIHJldHVybiBpdGVyKCsraSwgbGVuLCBpc0NsZWFuaW5nLCBicmFja2V0cywgY3VyLCBhY2MpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gaXRlcigwLCBzdHIubGVuZ3RoLCBpc0NsZWFuLCBicmFja2V0cywgc3RyLCBbXSlcbn07XG52YXIgY2hlY2tTeW50YXggPSAoc3RyKSA9PiB7XG4gIGNvbnN0IG5ld1N0ciA9IGdldE9ubHlCcmFja2V0cyhzdHIpO1xuICByZXR1cm4gYXJlQnJhY2tldHNJbk9yZGVyKG5ld1N0cikgPyAwIDogMTtcbn07XG5jb25zb2xlLmxvZygnY2hlY2tTeW50YXgnKVxuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4KFwiLS0tKCgoKCgoKCkpKSkpKSktLS0tXCIpID09PSAwKTtcbmNvbnNvbGUubG9nIChjaGVja1N5bnRheCAoXCJcIikgPT09IDApO1xuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4IChcImJlZm9yZSAoIG1pZGRsZSBbXSkgYWZ0ZXIgXCIpID09PSAwKTtcbmNvbnNvbGUubG9nIChjaGVja1N5bnRheCAoXCIpIChcIikgPT09IDEpO1xuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4IChcIn0ge1wiKSA9PT0gMSk7XG5jb25zb2xlLmxvZyAoY2hlY2tTeW50YXggKFwiPD4oXSlcIikgPT09IDEpO1xuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4IChcIiggIFsgIDw+ICAoKSAgXSAgPD4gIClcIikgPT09IDApO1xuY29uc29sZS5sb2cgKGNoZWNrU3ludGF4IChcIiAgICggICAgICBbKVwiKSA9PT0gMSk7XG5cbiIsIid1c2Ugc3RyaWN0JztcbmxldCBkc0NvdW50ID0gKC4uLmFyZ3MpID0+IHtcbiAgY29uc3QgW3N0ciwgLi4ucmVzdF0gPSBhcmdzO1xuICBjb25zdCBjb25jYXRlZFN1YnN0aW5ncyA9IHJlc3Quam9pbignJyk7XG4gIGNvbnN0IGl0ZXIgPSAoY291bnQsIHBvc2l0aW9uLCBjdXJyLCBzdWJzdHJpbmcpID0+IHtcbiAgICAgIGlmKGN1cnIuaW5kZXhPZihzdWJzdHJpbmcsIHBvc2l0aW9uKSA9PT0gLTEpIHJldHVybiBjb3VudDtcblxuICAgICAgbGV0IG5ld1Bvc2l0aW9uID0gY3Vyci5pbmRleE9mKHN1YnN0cmluZywgcG9zaXRpb24pO1xuICAgICAgcmV0dXJuIGl0ZXIoKytjb3VudCwgKytuZXdQb3NpdGlvbiwgY3Vyciwgc3Vic3RyaW5nKTtcbiAgfVxuXG4gIHJldHVybiBpdGVyKDAsIDAsIHN0ci50b0xvd2VyQ2FzZSgpLCBjb25jYXRlZFN1YnN0aW5ncy50b0xvd2VyQ2FzZSgpKVxuXG5cbn1cbmNvbnNvbGUubG9nKCdkc0NvdW50Jyk7XG50cnkge1xuICB0ZXN0KGRzQ291bnQsIFsnYWJfX19hYl9fJywgJ2EnLCAnYiddLCAyKTtcbiAgdGVzdChkc0NvdW50LCBbJ19fX2NkX19fXycsICdjJywgJ2QnXSwgMSk7XG4gIHRlc3QoZHNDb3VudCwgWydkZV9fX19fX18nLCAnZCcsICdlJ10sIDEpO1xuICB0ZXN0KGRzQ291bnQsIFsnMTJfMTJfXzEyJywgJzEnLCAnMiddLCAzKTtcbiAgdGVzdChkc0NvdW50LCBbJ19iYV9fX19fXycsICdhJywgJ2InXSwgMCk7XG4gIHRlc3QoZHNDb3VudCwgWydfYV9fYl9fX18nLCAnYScsICdiJ10sIDApO1xuICB0ZXN0KGRzQ291bnQsIFsnLWFiLdCwYi1hYicsICdhJywgJ2InXSwgMik7XG4gIHRlc3QoZHNDb3VudCwgWydhQWEnLCAnYScsICdhJ10sIDIpO1xuICBjb25zb2xlLmluZm8oXCJDb25ncmF0dWxhdGlvbnMhIEFsbCB0ZXN0cyBzdWNjZXNzIHBhc3NlZC5cIik7XG59IGNhdGNoKGUpIHtcbiAgY29uc29sZS5lcnJvcihlKTtcbn1cblxuLy8g0J/RgNC+0YHRgtCw0Y8g0YTRg9C90LrRhtC40Y8g0YLQtdGB0YLQuNGA0L7QstCw0L3QuNGPXG5cbmZ1bmN0aW9uIHRlc3QoY2FsbCwgYXJncywgY291bnQsIG4pIHtcbiAgbGV0IHIgPSAoY2FsbC5hcHBseShuLCBhcmdzKSA9PT0gY291bnQpO1xuICBjb25zb2xlLmFzc2VydChyLCBgRmluZGVkIGl0ZW1zIGNvdW50OiAke2NvdW50fWApO1xuICBpZiAoIXIpIHRocm93IFwiVGVzdCBmYWlsZWQhXCI7XG59XG5cbiIsImNvbnNvbGUubG9nKCdwYXJzZVVybCcpO1xubGV0IHBhcnNlVXJsID0gKHVybCkgPT4ge1xuICBsZXQgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgKCdhJyk7XG4gIGEuaHJlZiA9IHVybDtcbiAgcmV0dXJuIGE7XG59XG5cbmxldCBhID0gcGFyc2VVcmwoJ2h0dHA6Ly90dXR1LnJ1OjgwODAvZG8vYW55LnBocD9hPTEmYltdPWEmYltdPWIjZm9vJyk7XG5cbmNvbnNvbGUubG9nKGEuaHJlZik7XG5jb25zb2xlLmxvZyhhLmhhc2gpO1xuY29uc29sZS5sb2coYS5wb3J0KTtcbmNvbnNvbGUubG9nKGEuaG9zdCk7XG5jb25zb2xlLmxvZyhhLnByb3RvY29sKTtcbmNvbnNvbGUubG9nKGEuaG9zdG5hbWUpO1xuY29uc29sZS5sb2coYS5wYXRobmFtZSk7XG5jb25zb2xlLmxvZyhhLm9yaWdpbik7XG4iLCIvL9CX0LDQtNCw0YfQsCAjMVxuY29uc3QgZ2V0U3Vic3RyaW5nID0gKHtzdHIsIHN1YlN0cjEsIHN1YlN0cjJ9KSA9PiB7XG4gIGlmIChzdHIgPT09ICcnKSByZXR1cm4gLTE7XG4gIGxldCBzdWJTdHJQb3NpdGlvbjEgPSBzdHIubGFzdEluZGV4T2Yoc3ViU3RyMSwgc3RyLmxlbmd0aCAtIDEpO1xuICBsZXQgc3ViU3RyUG9zaXRpb24yID0gc3RyLmxhc3RJbmRleE9mKHN1YlN0cjIsIHN0ci5sZW5ndGggLSAxKTtcblxuICByZXR1cm4gc3ViU3RyUG9zaXRpb24xICE9PSAtMSA/IHN1YlN0clBvc2l0aW9uMSA6XG4gICAgICAgICBzdWJTdHJQb3NpdGlvbjIgIT09IC0xID8gc3ViU3RyUG9zaXRpb24yIDpcbiAgICAgICAgIHN1YlN0clBvc2l0aW9uMSA9PT0gc3ViU3RyUG9zaXRpb24yID8gc3ViU3RyUG9zaXRpb24xIDogLTE7XG5cbn1cblxuZnVuY3Rpb24gZnVuYyhzLCBhLCBiKSB7XG5cbiAgaWYgKHMubWF0Y2goL14kLykpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICB2YXIgaSA9IHMubGVuZ3RoIC0xO1xuICB2YXIgYUluZGV4ID0gICAgIC0xO1xuICB2YXIgYkluZGV4ID0gICAgIC0xO1xuXG4gIHdoaWxlICgoYUluZGV4ID09IC0xKSAmJiAoYkluZGV4ID09IC0xKSAmJiAoaSA+IDApKSB7XG4gICAgaWYgKHMuc3Vic3RyaW5nKGksIGkgKzEpID09IGEpIHtcbiAgICAgIGFJbmRleCA9IGk7XG4gICAgfVxuICAgIGlmIChzLnN1YnN0cmluZyhpLCBpICsxKSA9PSBiKSB7XG4gICAgICBiSW5kZXggPSBpO1xuICAgIH1cbiAgICBpID0gaSAtIDE7XG4gIH1cbiAgaWYgKGFJbmRleCAhPSAtMSkge1xuICAgIGlmIChiSW5kZXggPT0gLTEpIHtcbiAgICAgIHJldHVybiBhSW5kZXg7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgcmV0dXJuIE1hdGgubWF4KGFJbmRleCwgYkluZGV4KTtcbiAgICB9XG4gIH1cblxuICBpZiAoYkluZGV4ICE9IC0xKSB7XG4gICAgcmV0dXJuIGJJbmRleDtcbiAgfVxuICBlbHNlIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cbn1cblxuY29uc29sZS5sb2coXG4gICAgJ1JlZmFjdG9yaW5nIHRhc2sgMScsXG4gICAgZnVuYygnMTIzNDU1NjAnLCAnMCcsICcwJyksIGdldFN1YnN0cmluZyh7c3RyOiAnMTIzNDU1NjAnLCBzdWJTdHIxOiAnMCcsIHN1YlN0cjI6ICcwJ30pXG4pXG5cblxuLy/Ql9Cw0LTQsNGH0LAgMlxuY29uc3QgZHJhd1JhdGluZyA9ICh2b3RlLCByYW5nZSA9IFswLCAyMCwgNDAsIDYwLCA4MCwgMTAwXSwgc3RhcnMgPSAn4piF4piG4piG4piG4piGJykgPT4ge1xuICBsZXQgcmV0dXJuZWRWYWx1ZTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5nZS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgaWYgKHZvdGUgPj0gcmFuZ2VbaV0gJiYgdm90ZSA8PSByYW5nZVtpICsgMV0pIHtcbiAgICAgICByZXR1cm5lZFZhbHVlID0gc3RhcnM7XG4gICAgICAgYnJlYWs7XG4gICAgIH1cbiAgfVxuICByZXR1cm4gcmV0dXJuZWRWYWx1ZTtcbn1cbmxldCByYW5nZSA9IFswLCAyMCwgNDAsIDYwLCA4MCwgMTAwXTtcblxuLy8g0J/RgNC+0LLQtdGA0LrQsCDRgNCw0LHQvtGC0Ysg0YDQtdC30YPQu9GM0YLQsNGC0LBcbmNvbnNvbGUubG9nKGRyYXdSYXRpbmcoMCwgcmFuZ2UsICfimIXimIbimIbimIbimIYnKSApO1xuY29uc29sZS5sb2coZHJhd1JhdGluZygxLCByYW5nZSwgJ+KYheKYhuKYhuKYhuKYhicpICk7XG5jb25zb2xlLmxvZyhkcmF3UmF0aW5nKDUwLCByYW5nZSwgJ+KYheKYheKYheKYhuKYhicpKTtcbmNvbnNvbGUubG9nKGRyYXdSYXRpbmcoOTksIHJhbmdlLCAn4piF4piF4piF4piF4piFJykpOyJdfQ==
